<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bluetooth Manager</title>
  
  <!-- Skrypty i style CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/sidebar.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/device-modal.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/debug-modal.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/header.css') }}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <!-- Cyberpunk Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
  <!-- Ukryte pole do przechowywania informacji o urządzeniach -->
  <input type="hidden" id="has-devices" value="{{ 'true' if devices else 'false' }}">
  
  <!-- Ukryte miejsce dla logów -->
  <div class="hidden-logs">
    <div class="log-container">
      {% if logs %}
        {% for log in logs|reverse %}
          <div class="log-entry">{{ log }}</div>
        {% endfor %}
      {% else %}
        <p>Brak logów.</p>
      {% endif %}
    </div>
  </div>
  
  <!-- Ukryte formularze dla funkcjonalności debugowania -->
  <form action="/clear_logs" method="post" style="display: none;" id="hidden-clear-logs-form">
    <input type="hidden" name="clear" value="true">
  </form>
  
  <form action="/simulate_connection" method="post" style="display: none;" id="hidden-simulate-form">
    <input type="hidden" name="simulate" value="true">
  </form>

  <!-- Kontener dla alertów w prawym dolnym rogu -->
  <div id="toast-container" class="toast-container"></div>
  
  <div class="app-container">
    <!-- Cyberpunk Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-glow"></div>
      
      <!-- Sidebar Header -->
      <div class="sidebar-header">
        <div class="sidebar-title">
          <div class="neon-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
            </svg>
          </div>
          <span class="sidebar-title-text">DEVICES</span>
        </div>
        <button class="sidebar-toggle" id="sidebarToggle">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="15,18 9,12 15,6"></polyline>
          </svg>
        </button>
      </div>

      <!-- Filters -->
      <div class="sidebar-content" id="sidebarContent">
        <div class="filters-section">
          <div class="filter-group">
            <div class="terminal-input">
              <span class="terminal-prompt">FILTER:</span>
              <input type="text" id="sidebar-filter-name" placeholder="device_name">
            </div>
          </div>
          
          <div class="filter-group">
            <div class="terminal-select">
              <select id="sidebar-filter-type">
                <option value="">ALL_TYPES</option>
                <option value="headphones">HEADPHONES</option>
                <option value="speaker">SPEAKERS</option>
                <option value="mouse">MICE</option>
                <option value="keyboard">KEYBOARDS</option>
                <option value="gamepad">CONTROLLERS</option>
                <option value="other">OTHER</option>
              </select>
            </div>
          </div>

          <button class="clear-filters" id="clear-filters-btn">
            <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="1,4 1,10 7,10"></polyline>
              <path d="M3.51,15a9,9,0,0,0,2.13,3.09,9,9,0,0,0,13.72,0,9,9,0,0,0,0-12.72,9,9,0,0,0-13.72,0A8.96,8.96,0,0,0,3.51,9"></path>
            </svg>
            <span>CLEAR_FILTERS</span>
          </button>
        </div>

        <!-- Connected Device -->
        <div class="connected-device" id="connected-device-section" style="display: none;">
          <h3 class="section-title-active toggle-section" data-target="connected-device-container">
            <div class="status-indicator active"></div>
            <span> ACTIVE_CONNECTION</span>
            <svg class="dropdown-toggle open" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="6,9 12,15 18,9"></polyline>
            </svg>
          </h3>
          <div id="connected-device-container"></div>
        </div>

        <!-- Device Lists -->
        <div class="device-lists">
          <!-- Favorite Devices -->
          <div class="device-section" id="favorite-devices-section" style="display: none;">
            <h3 class="section-title favorite-section toggle-section" data-target="paired-devices-list">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polygon points="12,2 15.09,8.26 22,9.27 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9.27 8.91,8.26"/>
              </svg>
              <span> PRIORITY_DEVICES</span>
              <svg class="dropdown-toggle open" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="6,9 12,15 18,9"></polyline>
              </svg>
            </h3>
            <div class="device-list" id="paired-devices-list"></div>
          </div>

          <!-- Discovered Devices -->
          <div class="device-section">
            <h3 class="section-title toggle-section" data-target="discovered-devices-list">
              <span>DISCOVERED_DEVICES</span>
              <svg class="dropdown-toggle open" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="6,9 12,15 18,9"></polyline>
              </svg>
            </h3>
            <div class="device-list" id="discovered-devices-list">
              <div class="empty-state">
                <div class="empty-icon">
                  <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="m21 21-4.35-4.35"></path>
                  </svg>
                </div>
                <p>NO_DEVICES_DETECTED</p>
                <small>RUN_SCAN_PROTOCOL</small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </aside>

    <!-- Main content z nowym cyberpunk headerem -->
    <div class="main-content">
      <!-- CYBERPUNK HEADER - ZASTĄPIONY -->
      <header class="header">
        <div class="header-glow"></div>
        
        <div class="header-content">
          <!-- Logo -->
          <div class="logo-section">
            <div class="logo-icon">
              <svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor">
                <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
              </svg>
            </div>
            <div class="logo-text">
              <h1><span class="logo-cyber">CYBER</span>TOOTH</h1>
              <p>NEURAL LINK PROTOCOL v2.1.0</p>
            </div>
          </div>

          <!-- Search Terminal -->
          <div class="search-terminal">
            <div class="terminal-wrapper">
              <div class="terminal-content">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="4,17 10,11 4,5"></polyline>
                  <line x1="12" y1="19" x2="20" y2="19"></line>
                </svg>
                <span class="terminal-prompt">root@cybertooth:~$</span>
                <input type="text" id="header-search" placeholder="search devices...">
              </div>
            </div>
          </div>

          <!-- Actions -->
          <div class="header-actions">
            <!-- Connection Status -->
            <div class="connection-status" id="connectionStatus">
              <div class="status-indicator"></div>
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M5 12.55a11 11 0 0 1 14.08 0"></path>
                <path d="M1.42 9a16 16 0 0 1 21.16 0"></path>
                <path d="M8.53 16.11a6 6 0 0 1 6.95 0"></path>
                <line x1="12" y1="20" x2="12.01" y2="20"></line>
              </svg>
              <span id="statusText">OFFLINE</span>
              <button id="disconnectBtn" class="disconnect-btn" style="display: none;">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="18" y1="6" x2="6" y2="18"></line>
                  <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
              </button>
            </div>

            <!-- Scan Button -->
            <button class="scan-btn" id="header-scan-btn">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M3 7v10a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2z"></path>
                <polyline points="8,1 16,1 16,7 8,7 8,1"></polyline>
              </svg>
              <span id="scanBtnText">SCAN</span>
            </button>

            <!-- Add Device Button -->
            <button class="scan-btn add-device-btn" id="header-add-device-btn">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
              </svg>
              <span>ADD</span>
            </button>

            <!-- Security Indicator -->
            <div class="security-indicator">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
              </svg>
              <span>AES-256</span>
            </div>

            <!-- Theme Toggle -->
            <button class="icon-btn" id="theme-toggle">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
              </svg>
            </button>

            <!-- Settings -->
            <button class="icon-btn settings-btn" id="settings-btn">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
              </svg>
            </button>

            <!-- User Menu -->
            <div class="user-menu">
              <button class="icon-btn user-btn" id="login-btn">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                  <circle cx="12" cy="7" r="4"></circle>
                </svg>
              </button>
              <div class="user-dropdown" id="userDropdown">
                <button class="dropdown-item" id="register-btn">
                  <span>&gt; register.exe</span>
                </button>
                <button class="dropdown-item">
                  <span>&gt; profile.cfg</span>
                </button>
                <hr class="dropdown-divider">
                <button class="dropdown-item danger">
                  <span>&gt; logout.sh</span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </header>

      <!-- Widok Minecraft z przyciskiem SKANUJ i sekcją wyników -->
      <div class="minecraft-layout" id="minecraft-layout">
        <div class="minecraft-content">
          <div class="minecraft-content-overlay">
            <!-- Główna sekcja z tytułem i przyciskiem -->
            <div class="minecraft-main-section">
              <div class="minecraft-title">
                <h1>Bluetooth Manager</h1>
                <p>Wyszukaj i zarządzaj urządzeniami Bluetooth</p>
              </div>
              <form action="/scan" method="post" id="scan-form">
                <input type="hidden" name="show_results" value="true">
                <button type="submit" class="minecraft-play-button">SKANUJ</button>
              </form>
            </div>
            
            <!-- Kontener dla wyników -->
            <div class="minecraft-results-container">
              <div id="scan-results-section" class="scan-results-section" style="display: none;">
                <div class="scan-results-header">
                  <h3>Znalezione urządzenia</h3>
                  <div class="scan-results-filter">
                    <input type="text" id="scan-results-filter-input" placeholder="Filtruj po nazwie lub adresie MAC...">
                  </div>
                </div>
                <div class="scan-info-message">
                  <p>Upewnij się, że urządzenie jest włączone i wykrywalne. Wybierz urządzenie poniżej, aby nawiązać połączenie.</p>
                </div>
                <div id="scan-results-container" class="scan-results-container"></div>
                <div class="manual-device-link">
                  <p>Nie widzisz swojego urządzenia? <a href="#" id="open-manual-device-modal">Dodaj je ręcznie...</a></p>
                </div>
                <div class="scan-results-actions">
                  <button id="refresh-scan-results" class="btn btn-primary">
                    <i class="fas fa-sync-alt"></i> Odśwież listę
                  </button>
                  <button id="clear-scan-results" class="btn btn-outline">Anuluj</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Wszystkie modaly -->
  
  <!-- Modal logowania -->
  <div id="login-modal" class="modal auth-modal">
    <div class="modal-content auth-modal-content">
      <span class="close-modal">&times;</span>
      <div class="auth-header">
        <h2><i class="fas fa-sign-in-alt"></i> Zaloguj się</h2>
        <p>Wprowadź swoje dane logowania</p>
      </div>
      <form id="login-form" class="auth-form">
        <div class="form-group">
          <label for="login-email">Email:</label>
          <input type="email" id="login-email" required>
        </div>
        <div class="form-group">
          <label for="login-password">Hasło:</label>
          <input type="password" id="login-password" required>
        </div>
        <div class="form-group checkbox-group">
          <label>
            <input type="checkbox" id="remember-me">
            <span class="checkmark"></span>
            Zapamiętaj mnie
          </label>
        </div>
        <div class="form-actions">
          <button type="submit" class="btn btn-primary btn-auth">Zaloguj się</button>
        </div>
      </form>
      <div class="auth-footer">
        <p>Nie masz konta? <a href="#" id="switch-to-register">Zarejestruj się</a></p>
        <p><a href="#" id="forgot-password">Zapomniałeś hasła?</a></p>
      </div>
    </div>
  </div>

  <!-- Modal rejestracji -->
  <div id="register-modal" class="modal auth-modal">
    <div class="modal-content auth-modal-content">
      <span class="close-modal">&times;</span>
      <div class="auth-header">
        <h2><i class="fas fa-user-plus"></i> Zarejestruj się</h2>
        <p>Utwórz nowe konto</p>
      </div>
      <form id="register-form" class="auth-form">
        <div class="form-group">
          <label for="register-name">Imię i nazwisko:</label>
          <input type="text" id="register-name" required>
        </div>
        <div class="form-group">
          <label for="register-email">Email:</label>
          <input type="email" id="register-email" required>
        </div>
        <div class="form-group">
          <label for="register-password">Hasło:</label>
          <input type="password" id="register-password" required>
        </div>
        <div class="form-group">
          <label for="register-confirm-password">Potwierdź hasło:</label>
          <input type="password" id="register-confirm-password" required>
        </div>
        <div class="form-group checkbox-group">
          <label>
            <input type="checkbox" id="accept-terms" required>
            <span class="checkmark"></span>
            Akceptuję <a href="#" id="terms-link">regulamin</a> i <a href="#" id="privacy-link">politykę prywatności</a>
          </label>
        </div>
        <div class="form-actions">
          <button type="submit" class="btn btn-primary btn-auth">Zarejestruj się</button>
        </div>
      </form>
      <div class="auth-footer">
        <p>Masz już konto? <a href="#" id="switch-to-login">Zaloguj się</a></p>
      </div>
    </div>
  </div>

  <!-- Modal edycji urządzenia - CYBERPUNK STYLE -->
  <div id="device-edit-modal" class="modal">
    <div class="modal-content device-edit-modal-content">
      <span class="close-modal">&times;</span>
      
      <div class="modal-header device-edit-header">
        <h2><i class="fas fa-edit"></i> Edytuj urządzenie</h2>
        <p>Zmień ustawienia i właściwości urządzenia</p>
      </div>
      
      <form id="edit-device-form" class="device-edit-form">
        <input type="hidden" id="edit-device-address-hidden">
        
        <div class="form-section">
          <h3>Podstawowe informacje</h3>
          
          <div class="form-group">
            <label for="edit-device-name">
              <i class="fas fa-tag"></i>
              Nazwa urządzenia:
            </label>
            <input type="text" id="edit-device-name" required placeholder="np. Moje Słuchawki">
            <div class="input-hint">Nazwa wyświetlana w aplikacji</div>
          </div>
          
          <div class="form-group">
            <label for="edit-device-type">
              <i class="fas fa-list"></i>
              Typ urządzenia:
            </label>
            <select id="edit-device-type" required>
              <option value="headphones">🎧 Słuchawki</option>
              <option value="speaker">🔊 Głośnik</option>
              <option value="keyboard">⌨️ Klawiatura</option>
              <option value="mouse">🖱️ Mysz</option>
              <option value="gamepad">🎮 Kontroler</option>
              <option value="phone">📱 Telefon</option>
              <option value="tablet">📱 Tablet</option>
              <option value="laptop">💻 Laptop</option>
              <option value="desktop">🖥️ Komputer</option>
              <option value="other">📱 Inne</option>
            </select>
            <div class="input-hint">Wybierz typ dla lepszej organizacji</div>
          </div>
          
          <div class="form-group mac-address-display">
            <label for="edit-device-address-display">
              <i class="fas fa-wifi"></i>
              Adres MAC:
            </label>
            <input type="text" id="edit-device-address-display" disabled readonly>
            <div class="input-hint">Adres MAC nie może być zmieniony</div>
          </div>
        </div>
        
        <div class="form-actions">
          <button type="submit" class="btn btn-primary">
            <i class="fas fa-save"></i>
            Zapisz zmiany
          </button>
          <button type="button" class="btn btn-outline" id="cancel-edit-device">
            <i class="fas fa-times"></i>
            Anuluj
          </button>
          <button type="button" class="btn btn-danger" id="delete-device-btn">
            <i class="fas fa-trash"></i>
            Usuń urządzenie
          </button>
        </div>
        
        <div class="modal-warning">
          <i class="fas fa-exclamation-triangle"></i>
          <div>
            <strong>Uwaga:</strong> Nie można edytować urządzenia, które jest aktualnie połączone. 
            Najpierw rozłącz urządzenie, aby móc wprowadzić zmiany.
          </div>
        </div>
      </form>
    </div>
  </div>
  
  <!-- Modal szczegółów urządzenia -->
  <div id="device-details-modal" class="modal device-details-modal">
    <div class="modal-content device-modal-content">
      <span class="close-modal" id="close-device-details">&times;</span>
      
      <div class="device-details-header">
        <div class="device-info">
          <h2 id="modal-device-name">Nazwa urządzenia</h2>
          <div class="device-address" id="modal-device-address">00:00:00:00:00:00</div>
          <div class="device-type" id="modal-device-type">Typ urządzenia</div>
        </div>
        <div class="connection-status">
          <span id="modal-device-status" class="status-text">Niepołączone</span>
          <div class="connection-actions">
            <button id="modal-connect-btn" class="btn btn-primary btn-small">Połącz</button>
            <button id="modal-disconnect-btn" class="btn btn-warning btn-small">Rozłącz</button>
          </div>
        </div>
      </div>
      
      <div class="device-tabs">
        <button class="tab-btn active" data-tab="control-tab">Sterowanie</button>
        <button class="tab-btn" data-tab="logs-tab">Logi</button>
      </div>
      
      <div class="tab-content">
        <div id="control-tab" class="tab-panel active">
          <div class="control-section">
            <h3>Przyciski sterujące</h3>
            <div class="device-buttons" id="modal-device-buttons">
              <div class="no-buttons-message">Brak zdefiniowanych przycisków dla tego urządzenia.</div>
            </div>
            
            <div class="control-actions">
              <button id="add-device-button" class="btn btn-primary">Dodaj nowy przycisk</button>
            </div>
            
            <div id="modal-button-form" class="modal-form-section" style="display: none;">
              <h4>Nowy przycisk</h4>
              <div class="form-group">
                <label for="modal-button-name">Nazwa przycisku:</label>
                <input type="text" id="modal-button-name" placeholder="np. Włącz LED">
              </div>
              
              <div class="form-group">
                <label for="modal-button-function">Funkcja przycisku (opcjonalnie):</label>
                <select id="modal-button-function">
                  <option value="">Brak (zwykły przycisk)</option>
                  <option value="power">Zasilanie</option>
                  <option value="volume-up">Głośność</option>
                  <option value="light">Światło/LED</option>
                </select>
                <div class="hint">Wybierz funkcję, aby dodać ikonę do przycisku</div>
              </div>
              
              <div class="commands-container" id="modal-commands-container">
                <div class="command-field">
                  <input type="text" class="command-input" placeholder="Dane w formacie HEX (np. 0x01020304)">
                  <input type="number" class="delay-input" placeholder="Opóźnienie (ms)" min="0">
                  <button type="button" class="remove-command btn-small btn-warning">Usuń</button>
                </div>
              </div>
              
              <div class="form-actions">
                <button type="button" id="modal-add-command" class="btn btn-small">Dodaj komendę</button>
                <button type="button" id="modal-save-button" class="btn">Zapisz przycisk</button>
                <button type="button" id="modal-cancel-button" class="btn btn-outline">Anuluj</button>
              </div>
            </div>
            
            <div class="unpair-action">
              <button id="modal-unpair-btn" class="btn btn-danger">Rozparuj urządzenie</button>
            </div>
          </div>
        </div>
        
        <div id="logs-tab" class="tab-panel">
          <div class="device-logs-container">
            <div class="logs-header"></div>
            
            <div class="logs-filter-form">
              <div class="logs-filter-row date-range">
                <div class="filter-field">
                  <label for="log-filter-date-from">Od daty:</label>
                  <input type="date" id="log-filter-date-from" class="log-filter-input">
                </div>
                <div class="filter-field">
                  <label for="log-filter-date-to">Do daty:</label>
                  <input type="date" id="log-filter-date-to" class="log-filter-input">
                </div>
              </div>
              
              <div class="logs-filter-row time-range">
                <div class="filter-field">
                  <label for="log-filter-time-from">Od godziny:</label>
                  <input type="time" id="log-filter-time-from" class="log-filter-input">
                </div>
                <div class="filter-field">
                  <label for="log-filter-time-to">Do godziny:</label>
                  <input type="time" id="log-filter-time-to" class="log-filter-input">
                </div>
              </div>
              
              <div class="logs-filter-row">
                <div class="filter-field filter-text">
                  <label for="log-filter-text">Tekst:</label>
                  <input type="text" id="log-filter-text" class="log-filter-input" placeholder="Filtruj po tekście...">
                </div>
              </div>
              
              <div class="logs-filter-actions">
                <button id="apply-log-filters" class="btn btn-small">Zastosuj filtry</button>
                <button id="clear-log-filters" class="btn btn-small btn-outline">Wyczyść filtry</button>
              </div>
            </div>
            
            <div class="device-log-content" id="device-log-content">
              <div class="no-logs-message">Brak logów dla tego urządzenia.</div>
            </div>
            <div class="logs-header">
              <button id="clear-device-logs" class="btn btn-small btn-warning">Wyczyść logi</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Modal ręcznego dodawania urządzenia -->
  <div id="add-manual-device-modal" class="modal">
    <div class="modal-content">
      <span class="close-modal" id="close-manual-device-modal">&times;</span>
      <h2>Dodaj urządzenie ręcznie</h2>
      <form id="add-manual-device-form">
        <div class="form-group">
          <label for="manual-device-name">Nazwa urządzenia:</label>
          <input type="text" id="manual-device-name" placeholder="np. Moje Słuchawki" required>
        </div>
        <div class="form-group">
          <label for="manual-device-address">Adres MAC:</label>
          <input type="text" id="manual-device-address" placeholder="Format: 00:11:22:33:44:55" required pattern="([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})">
          <div class="hint">Format adresu MAC: 00:11:22:33:44:55</div>
        </div>
        <div class="form-group">
          <label for="manual-device-type">Typ urządzenia:</label>
          <select id="manual-device-type" required>
            <option value="headphones">Słuchawki</option>
            <option value="speaker">Głośnik</option>
            <option value="keyboard">Klawiatura</option>
            <option value="mouse">Mysz</option>
            <option value="gamepad">Kontroler</option>
            <option value="other" selected>Inne</option>
          </select>
        </div>
        <div class="form-actions">
          <button type="submit" class="btn btn-primary">Dodaj urządzenie</button>
          <button type="button" id="cancel-manual-device" class="btn btn-outline">Anuluj</button>
        </div>
      </form>
    </div>
  </div>
  
  <!-- Przycisk debugowania -->
  <div id="debug-trigger" title="Otwórz narzędzia debugowania" style="bottom: 80px;">
    <i class="fas fa-bug"></i>
  </div>

  <!-- Modal debugowania -->
  <div id="debug-modal" class="debug-modal">
    <div class="modal-content">
      <span class="close-modal" id="close-debug-modal">&times;</span>
      
      <div class="modal-header">
        <h2>Narzędzia Debugowania</h2>
      </div>
      
      <div class="debug-section">
        <h3>Zarządzanie urządzeniami</h3>
        <div class="debug-actions">
          <form id="simulate-connection-debug" action="/simulate_connection" method="post">
            <button type="button" class="btn btn-simulate">Symuluj połączenie</button>
          </form>
          <button id="add-test-device-debug" class="btn btn-primary">Dodaj testowe urządzenie</button>
        </div>
        
        <div class="debug-form">
          <div class="form-group">
            <label for="debug-device-name">Nazwa:</label>
            <input type="text" id="debug-device-name" value="Testowe Urządzenie">
          </div>
          <div class="form-group">
            <label for="debug-device-address">Adres MAC:</label>
            <input type="text" id="debug-device-address" value="00:11:22:33:44:55">
          </div>
          <div class="form-group">
            <label for="debug-device-type">Typ urządzenia:</label>
            <select id="debug-device-type">
              <option value="headphones">Słuchawki</option>
              <option value="speaker">Głośnik</option>
              <option value="keyboard">Klawiatura</option>
              <option value="mouse">Mysz</option>
              <option value="gamepad">Kontroler</option>
              <option value="other" selected>Inne</option>
            </select>
          </div>
        </div>
      </div>
      
      <div class="debug-section">
        <h3>Logi Systemu</h3>
        
        <div class="debug-logs-filter-form">
          <div class="logs-filter-row date-range">
            <div class="filter-field">
              <label for="debug-log-filter-date-from">Od daty:</label>
              <input type="date" id="debug-log-filter-date-from" class="log-filter-input">
            </div>
            <div class="filter-field">
              <label for="debug-log-filter-date-to">Do daty:</label>
              <input type="date" id="debug-log-filter-date-to" class="log-filter-input">
            </div>
          </div>
          
          <div class="logs-filter-row time-range">
            <div class="filter-field">
              <label for="debug-log-filter-time-from">Od godziny:</label>
              <input type="time" id="debug-log-filter-time-from" class="log-filter-input">
            </div>
            <div class="filter-field">
              <label for="debug-log-filter-time-to">Do godziny:</label>
              <input type="time" id="debug-log-filter-time-to" class="log-filter-input">
            </div>
          </div>
          
          <div class="logs-filter-row">
            <div class="filter-field filter-text">
              <label for="debug-log-filter-text">Tekst:</label>
              <input type="text" id="debug-log-filter-text" class="log-filter-input" placeholder="Filtruj po tekście...">
            </div>
          </div>
          
          <div class="logs-filter-actions">
            <button id="apply-debug-log-filters" class="btn btn-small">Zastosuj filtry</button>
            <button id="clear-debug-log-filters" class="btn btn-small btn-outline">Wyczyść filtry</button>
          </div>
        </div>
        
        <div id="debug-log-viewer" class="log-viewer">
          <div class="log-entry">Ładowanie logów...</div>
        </div>
        <div class="log-controls">
          <button id="clear-debug-logs" class="btn btn-warning">Wyczyść logi</button>
          <button id="refresh-debug-logs" class="btn">Odśwież logi</button>
        </div>
      </div>
    </div>
  </div>

  <!-- JavaScript -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script> 
  <script src="{{ url_for('static', filename='js/bluetooth.js') }}"></script>
  <script src="{{ url_for('static', filename='js/sidebar.js') }}"></script>
  <script src="{{ url_for('static', filename='js/device-modal.js') }}"></script>
  <script src="{{ url_for('static', filename='js/debug-modal.js') }}"></script>
  <script src="{{ url_for('static', filename='js/header.js') }}"></script>
  <script src="{{ url_for('static', filename='js/main.js') }}"></script>
  
  {% if connect_script %}
    {{ connect_script|safe }}
  {% endif %}
</body>
</html>